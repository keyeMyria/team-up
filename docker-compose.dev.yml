version: '2'

services:
  tu-django:
    build:
      args:
        - py_requirements=requirements.txt
    command: bash docker/entrypoint.dev.sh
    env_file:
      - server/env/dev.env
    volumes:
      - ./server/:/opt/tu/django/
    ports:
      - '8001:8001'

  tu-postgres:
    ports:
      - '5432:5432'

  tu-redis:
    ports:
      - '6379:6379'

  tu-nginx:
    volumes:
      - ./client/src/:/opt/tu/static
      - ./nginx/configurations:/etc/nginx/configurations
    command: bash entry-point.dev.sh

  tu-livereload:
    build:
      context: ./client/
      dockerfile: docker/Dockerfile-livereload
    container_name: 'tu-livereload'
    labels:
      application: 'tu-livereload'
    volumes:
      - ./client/:/opt/team-up/static
    expose:
      - '4200'
    ports:
      - '4200:4200'
    command: npm run dev
